### ディレクトリ構成

````markdown
backend/
├── cmd/                         # エントリーポイント（アプリケーションの起動コード）
│   └── server/
│       └── main.go              # サーバーの起動と依存関係の設定
├── internal/                    # 内部実装用（Go特有のディレクトリ、外部からのアクセスは不可）
│   ├── app/                     # アプリケーション層（ユースケース、サービス）
│   │   ├── service/             # アプリケーションサービス（ユースケースロジック、ビジネスロジックを呼び出す）
│   │   ├── dto/                 # データ転送オブジェクト（DTO）※データ変換に専念
│   │   └── command/             # ユースケースコマンド（特定のアクションを表現）
│   ├── domain/                  # ドメイン層（ビジネスロジック、エンティティ、インターフェース）
│   │   ├── model/               # ドメインモデル（ビジネスルールとデータ構造の定義）
│   │   ├── repository/          # リポジトリインターフェース（データの永続化操作）
│   │   └── service/             # ドメインサービス（ビジネスロジックをカプセル化、外部依存を避ける）
│   ├── infra/                   # インフラストラクチャ層（技術的な実装、外部サービス）
│   │   ├── persistence/         # 永続化（リポジトリの実装、DBアクセス）
│   │   ├── service/             # 外部サービスの統合ロジック（API、ファイル操作など）
│   │   ├── container/           # DI（依存性注入）の設定（サービスの依存関係管理）
│   │   └── config/              # 設定管理（環境設定、構成情報）
│   ├── interface/               # インターフェース層（プレゼンテーション層）
│   │   ├── api/                 # Web APIエンドポイント（リクエストハンドリング）
│   │   ├── grpc/                # gRPCサービス（リモート手続き呼び出しのエンドポイント）
│   ├── routes/                  # エンドポイント管理（ルーティング設定）
│   └── shared/                  # 共通のユーティリティ、ヘルパー、共通モジュール
│       ├── utils/               # 汎用的なユーティリティ（共通関数）
│       └── middleware/          # ミドルウェア（リクエストのフィルタリング、エラーハンドリング）
├── pkg/                         # 外部に公開可能なライブラリ（内部ロジックから分離）
│   └── somepkg/                 # パッケージ例
├── api/                         # OpenAPI/SwaggerやgRPCプロトコルの定義
│   ├── openapi.yaml             # API定義ファイル
│   └── protobuf/                # gRPCのprotobufファイル
├── scripts/                     # スクリプト（セットアップ、デプロイ、メンテナンス）
│   ├── setup.sh                 # 初期セットアップスクリプト
│   └── deploy.sh                # デプロイスクリプト
├── docs/                        # ドキュメント（設計書、使用説明書）
│   ├── architecture.md          # アーキテクチャの概要
│   └── api.md                   # APIの使用説明書
├── .gitignore                   # Gitで無視するファイルリスト
├── go.mod                       # Goモジュールファイル
└── go.sum                       # 依存関係のバージョン管理ファイル

````    

### セットアップ

1. Goの依存関係をインストール
    ```bash
    go mod tidy
    ```

2. サーバー起動
    ```bash
    go run ./cmd/server/main.go
    ```


### テストの前提条件

プロジェクトのテストを実行する前に、以下の依存ライブラリとツールがインストールされていることを確認してください。

1. **依存ライブラリのインストール**:
   テストを実行するためには、必要なライブラリがインストールされている必要があります。以下のコマンドを使用して、`go mod tidy`を実行し、必要な依存関係をインストールしてください。

   ```bash
   go mod tidy
   ```

2. **モック生成ツールのインストール**:
   テストではgo mockを使用してモックを生成しています。まだインストールされていない場合は、以下のコマンドでインストールしてください。

   ```bash
   go install github.com/golang/mock/mockgen@latest
   ``` 

   もしmock genコマンドが見つからない場合、GOPATH/binがPATHに含まれていない可能性があります。以下のようにしてGOPATH/binをPATHに追加します
   ```bash
   export PATH=$PATH:$(go env GOPATH)/bin
   ```

---

### **モックの生成**

## モックの生成

もしモックのインターフェースが変更された場合や、新しいインターフェースが追加された場合は、`mockgen`を使用してモックを再生成する必要があります。以下のコマンドを使用してモックを生成してください。

```bash
mockgen -source=internal/infra/service/transcribe_service_mock.go -destination=internal/infra/service/mock_transcribe_service.go -package=service
```

---

### **テストの実行手順**

## テストの実行手順

1. プロジェクトのルートディレクトリから以下のコマンドを実行して、すべてのテストを実行します。
   このコマンドは、infra/serviceディレクトリ配下のすべてのテストを実行し、詳細な出力を表示します
   ```bash
   go test ./internal/infra/service -v
   ```
2. **テストカバレッジの確認（オプション）**
   テストカバレッジを確認するには、-coverオプションを使用して以下のコマンドを実行してください。
   ```bash
   go test ./internal/infra/service -v -cover
   ```
   テストカバレッジの出力が表示され、コードベースのカバレッジ率を確認できます。


---

### **注意点**

- テスト実行前に必ず最新のコードをリポジトリからプルしてください。
- テストケースが失敗した場合、出力されたエラーメッセージを元にデバッグを行ってください。
- モックを使用しているため、実際のAWSリソースは変更されませんが、実際のAWSクレデンシャルや設定が誤っていないことを確認してください。


---




